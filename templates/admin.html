{% extends "base.html" %}

{% block content %}
<div class="container mx-auto px-6 py-10">
    <h1 class="text-3xl font-bold mb-8 text-primary border-b border-gray-700 pb-4 flex justify-between items-center">
        <span>ðŸ‘® Admin Dashboard</span>
        <span class="text-sm text-gray-400 font-normal">Welcome, {{ user.name }}</span>
    </h1>

    <div class="grid md:grid-cols-3 gap-8">
        
        <div class="bg-gray-900 p-6 rounded-xl border border-gray-800 h-fit">
            <h2 class="text-xl font-bold mb-4 text-white"><i class="fas fa-rocket text-secondary"></i> Add Project</h2>
            <form action="/add-project" method="POST" class="space-y-4">
                <input type="text" name="title" placeholder="Project Title" required class="w-full bg-black p-3 rounded border border-gray-700 text-white focus:border-primary outline-none">
                <input type="text" name="category" placeholder="Category (e.g. AI Bot)" required class="w-full bg-black p-3 rounded border border-gray-700 text-white focus:border-primary outline-none">
                <input type="text" name="image_url" placeholder="Image URL" required class="w-full bg-black p-3 rounded border border-gray-700 text-white focus:border-primary outline-none">
                <textarea name="description" placeholder="Details..." rows="2" class="w-full bg-black p-3 rounded border border-gray-700 text-white focus:border-primary outline-none"></textarea>
                <button type="submit" class="w-full bg-secondary text-white font-bold py-3 rounded hover:bg-purple-600 transition">Upload</button>
            </form>

            <div class="mt-6 border-t border-gray-700 pt-4">
                <h3 class="text-sm font-bold text-gray-400 mb-2">Existing Projects</h3>
                <div class="space-y-2 max-h-40 overflow-y-auto">
                    {% for p in projects %}
                    <div class="flex justify-between items-center bg-black p-2 rounded border border-gray-800 text-xs">
                        <span class="text-gray-300 truncate w-32">{{ p.title }}</span>
                        <a href="/delete-project/{{ p._id }}" onclick="return confirm('Delete this project?')" class="text-red-500 hover:text-red-400"><i class="fas fa-trash"></i></a>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>

        <div class="bg-gray-900 p-6 rounded-xl border border-gray-800 h-[80vh] overflow-y-auto">
            <h2 class="text-xl font-bold mb-4 text-white"><i class="fas fa-envelope text-primary"></i> Client Leads</h2>
            {% for q in queries %}
            <div class="bg-black p-4 rounded-xl border border-gray-800 mb-4 relative hover:border-gray-600 transition">
                <a href="/update-query/{{ q._id }}" class="absolute top-4 right-4 text-[10px] font-bold px-2 py-1 rounded uppercase cursor-pointer {{ 'bg-green-500 text-black' if q.status == 'Completed' else 'bg-yellow-500 text-black' }}">
                    {{ q.status }}
                </a>

                <h3 class="font-bold text-white">{{ q.user_name }}</h3>
                <p class="text-xs text-primary mb-2">{{ q.service_type }}</p>
                <div class="bg-gray-900 p-3 rounded text-sm text-gray-300 italic mb-2">"{{ q.message }}"</div>
                <div class="flex justify-between items-center text-xs text-gray-500">
                    <span>{{ q.user_email }}</span>
                    <span>{{ q.date.strftime('%d %b') }}</span>
                </div>
            </div>
            {% else %}
            <p class="text-gray-500 text-center">No queries yet.</p>
            {% endfor %}
        </div>

        <div class="bg-gray-900 p-6 rounded-xl border border-gray-800 h-[80vh] overflow-y-auto">
            <h2 class="text-xl font-bold mb-4 text-white"><i class="fas fa-star text-yellow-400"></i> Manage Reviews</h2>
            {% for r in reviews %}
            <div class="bg-black p-4 rounded-xl border border-gray-800 mb-4 flex justify-between items-start group">
                <div>
                    <div class="text-yellow-400 text-xs mb-1">
                        {% for i in range(r.rating) %}â˜…{% endfor %}
                    </div>
                    <p class="text-gray-300 text-sm italic mb-1">"{{ r.comment }}"</p>
                    <p class="text-xs text-gray-500">- {{ r.user_name }}</p>
                </div>
                <a href="/delete-review/{{ r._id }}" onclick="return confirm('Delete this review?')" class="text-gray-600 hover:text-red-500 transition">
                    <i class="fas fa-trash"></i>
                </a>
            </div>
            {% else %}
            <p class="text-gray-500 text-center">No reviews yet.</p>
            {% endfor %}
        </div>

    </div>
</div>
{% endblock %}
